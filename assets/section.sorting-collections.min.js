!function(t){"use strict";theme.SortingCollections=function(){function e(e){this.$container=t(e),this.namespace=".sorting-collections",this.onLoad()}return e.prototype=t.extend({},Section.prototype,e.prototype,{onLoad:function(){var e=this.$container.find("[data-sorting-collections-control]"),o=this.$container.find("[data-sorting-collections-ajax] [data-collection]"),n=this.$container.find("[data-sorting-collections-items]"),i=this.$container.find("[data-sorting-collections-more]"),a=null;function r(o,r){a&&a.abort(),r&&theme.Loader.set(n);var c=o.attr("data-collection"),s=n.attr("data-limit"),l=n.attr("data-grid");a=t.ajax({type:"GET",url:theme.routes.root_url+"collections/"+c,cache:!1,data:{view:"sorting",count_limit:s,grid_classes:encodeURIComponent(l)},dataType:"html",success:function(t){var c;if(n.html(t),n[0].hasAttribute("data-is-design-mode")&&((c=n.children()).addClass(l),c.length>s))for(var d=s;d<c.length;d++)c.eq(d).remove();theme.ImagesLazyLoad.update(),theme.ProductCurrency.update(),theme.ProductCountdown.init(n.find(".js-countdown").removeClass("js-countdown--lazy")),theme.ProductReview.update(),e.find("a").removeClass("active"),o.addClass("active"),i&&i.text(theme.strings.homepage.sorting_collections.button_more_products.replace("{{ collection }}",o.text())).attr("href",o.attr("href")),r&&theme.Loader.unset(n),a=null}})}this.$control=e,o.length&&r(o.first()),e.on("click","a",(function(e){var o=t(this);return o.hasClass("active")||r(o,!0),e.preventDefault(),!1}))},onUnload:function(){this.$container.off(this.namespace),this.$control.off()}}),e}(),t((function(){theme.sections.register("sorting-collections",theme.SortingCollections)}))}(jQueryTheme);